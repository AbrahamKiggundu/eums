<div class="container">
    <ng-include src="'/static/app/views/partials/navigation-tabs.html'"></ng-include>

    <div ng-controller="NewDistributionPlanController" ng-init="initialize()">
        <div>
            <h4>Create A Distribution Plan</h4>

            <div>
                <select style="width: 140px;" ng-model="salesOrderItemSelected" required="required"
                        ng-options="salesOrderItem.display for salesOrderItem in salesOrderItems">
                    <option value="" selected="selected">Select Item</option>
                </select>
            </div>

            <div ng-show="hasSalesOrderItems" class="sales-order-list">
                <alert ng-show="!hasItemsLeft()" type="danger">All quantities have been assigned for this item.</alert>
                <table style="width: 60%">
                    <th>Sales Order</th>
                    <th>Material</th>
                    <th>Item Description</th>
                    <th>Quantity</th>
                    <th>Unit</th>

                    <tr>
                        <td>{{selectedSalesOrder.order_number}}</td>
                        <td>{{salesOrderItemSelected.material_code}}</td>
                        <td>{{salesOrderItemSelected.display}}</td>
                        <td>{{salesOrderItemSelected.quantity}}</td>
                        <td>{{salesOrderItemSelected.unit}}</td>
                    </tr>
                </table>
            </div>

            <div ng-show="hasSalesOrderItems" class="sales-order-list">
                <div ng-show="hasDistributionPlanItems">
                    <table style="width: 100%" id="distributionPlanTable">
                        <th style="width: 10%">Sales Order</th>
                        <th style="width: 10%">Item Description</th>
                        <th style="width: 5%">Sales Order Qty</th>
                        <th style="width: 5%">Unit</th>
                        <th style="width: 5%">Targeted Qty</th>
                        <th style="width: 10%">Planned Distr Date</th>
                        <th style="width: 10%">Programme Focal</th>
                        <th style="width: 10%">Consignee</th>
                        <th style="width: 10%">Contact Person</th>
                        <th style="width: 5%">Phone</th>
                        <th style="width: 10%">Region/District</th>
                        <th style="width: 10%">Mode of Delivery</th>
                        <th style="width: 5%">Trackable</th>

                        <tr ng-repeat="distributionPlanItem in distributionPlanItems">
                            <td>{{selectedSalesOrder.order_number}}</td>
                            <td>{{salesOrderItemSelected.display}}</td>
                            <td>{{distributionPlanItem.quantity}}</td>
                            <td>{{salesOrderItemSelected.unit}}</td>
                            <td ng-show="hasTargetedQuantity(distributionPlanItem)">
                                {{distributionPlanItem.targeted_quantity}}
                            </td>
                            <td ng-show="hasTargetedQuantity(distributionPlanItem)">
                                {{distributionPlanItem.planned_distribution_date}}
                            </td>
                            <td ng-show="hasTargetedQuantity(distributionPlanItem)">
                                {{distributionPlanItem.programme_focal}}
                            </td>
                            <td ng-show="hasTargetedQuantity(distributionPlanItem)">{{distributionPlanItem.consignee}}
                            </td>
                            <td ng-show="hasTargetedQuantity(distributionPlanItem)">
                                {{distributionPlanItem.contact_person}}
                            </td>
                            <td ng-show="hasTargetedQuantity(distributionPlanItem)">
                                {{distributionPlanItem.contact_phone_number}}
                            </td>
                            <td ng-show="hasTargetedQuantity(distributionPlanItem)">
                                {{distributionPlanItem.destination_location}}
                            </td>
                            <td ng-show="hasTargetedQuantity(distributionPlanItem)">
                                {{distributionPlanItem.mode_of_delivery}}
                            </td>

                            <td ng-show="!hasTargetedQuantity(distributionPlanItem)"><input type="text"
                                                                                            class="input-quantity"
                                                                                            ng-model="distributionPlanItem.target_quantity">
                            </td>
                            <td ng-show="!hasTargetedQuantity(distributionPlanItem)"><input data-provide="datepicker" class="datepicker" data-date-format="yyyy-mm-dd"
                                                                                            required="required"
                                                                                            ng-model="distributionPlanItem.planned_distribution_date">
                            </td>
                            <td ng-show="!hasTargetedQuantity(distributionPlanItem)"><select class="table-select"
                                                                                             ng-model="distributionPlanItem.programme_focal"
                                                                                             required="required"
                                                                                             ng-options="focal.name for focal in programme_focals">
                                <option value="" selected="selected">Select</option>
                            </select></td>
                            <td ng-show="!hasTargetedQuantity(distributionPlanItem)"><select class="table-select"
                                                                                             ng-model="distributionPlanItem.consignee"
                                                                                             required="required"
                                                                                             ng-options="consignee.name for consignee in consignees">
                                <option value="" selected="selected">Select</option>
                            </select></td>


                            <td ng-show="!hasTargetedQuantity(distributionPlanItem)"><select class="table-select"
                                                                                             ng-model="distributionPlanItem.contact_person"
                                                                                             required="required"
                                                                                             ng-options="contact_person.name for contact_person in contact_persons">
                                <option value="" selected="selected">Select</option>
                            </select></td>


                            <td ng-show="!hasTargetedQuantity(distributionPlanItem)"><input type="text"
                                                                                            class="input-phone-number"
                                                                                            value="{{distributionPlanItem.contact_phone_number}}"
                                                                                            ng-model="distributionPlanItem.contact_phone_number"></td>


                            <td ng-show="!hasTargetedQuantity(distributionPlanItem)"><select class="table-select"
                                                                                             ng-model="distributionPlanItem.destination_location"
                                                                                             required="required"
                                                                                             ng-options="district.name for district in districts">
                                <option value="" selected="selected">Select</option>
                            </select></td>


                            <td ng-show="!hasTargetedQuantity(distributionPlanItem)"><select class="table-select"
                                                                                             ng-model="distributionPlanItem.mode_of_delivery"
                                                                                             required="required">
                                <option value="Direct Delivery">Direct Delivery</option>
                                <option value="WH(warehouse)">WH(warehouse)</option>
                                <option value="" selected="selected">Select</option>
                            </select>
                            </td>

                            <td><input type="checkbox" ng-model="distributionPlanItem.tracked"
                                       checked="distributionPlanItem.tracked"></td>
                        </tr>
                    </table>
                </div>

                <div>
                    <button ng-show="hasItemsLeft()" type="button" class="btn btn-primary" ng-click="addDistributionPlanItem()"><i
                            class="glyphicon glyphicon-plus"> </i>Add IP
                    </button>
                    <div ng-show="hasDistributionPlanItems" style="float: right">
                        <button ng-show="hasItemsLeft()" type="button" class="btn btn-primary"
                                ng-click="saveDistributionPlanItem(distributionPlanItems)"><i
                                class="glyphicon glyphicon-save"> </i>Save
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>